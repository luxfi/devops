# Hanzo Bot secrets synced from Hanzo KMS (production).
#
# Prerequisites:
# 1. In https://kms.hanzo.ai create project "bot" and environment "production".
# 2. Store all bot/app secrets in that KMS project (examples):
#    - AUTH_GITHUB_ID
#    - AUTH_GITHUB_SECRET
#    - AUTH_GITLAB_ID
#    - AUTH_GITLAB_SECRET
#    - OPENAI_API_KEY
#    - ANTHROPIC_API_KEY
#    - BOT_GATEWAY_TOKEN
#    - BOT_GATEWAY_PASSWORD
# 3. Create a machine identity with read access.
# 4. Create/rotate auth secret out-of-band (do not commit plaintext credentials):
#      kubectl -n hanzo create secret generic bot-kms-auth \
#        --from-literal=clientId=<id> \
#        --from-literal=clientSecret=<secret> \
#        --dry-run=client -o yaml | kubectl apply -f -
---
apiVersion: secrets.lux.network/v1alpha1
kind: KMSSecret
metadata:
  name: bot-kms-sync
  namespace: hanzo
  labels:
    app.kubernetes.io/name: bot-site
    app.kubernetes.io/component: secrets
    app.kubernetes.io/part-of: hanzo-platform
spec:
  hostAPI: https://kms.hanzo.ai
  resyncInterval: 60
  authentication:
    universalAuth:
      credentialsRef:
        secretName: bot-kms-auth
        secretNamespace: hanzo
      secretsScope:
        projectSlug: bot
        envSlug: production
        secretsPath: /
  managedSecretReference:
    secretName: bot-secrets
    secretNamespace: hanzo
    secretType: Opaque
